<!-- Modal -->
<div class="modal fade" id="invite_people_form" tabindex="-1" role="dialog" aria-labelledby="myModelLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Invite your friends to TwoNoo!</h4>
      </div>
      <div class="modal-body">
        Enter e-mails of people to invite separated by commas.<br/>
	<textarea id="emails" name="emails" style="width: 100%;"> </textarea>
<br/><br/>
<div style="width:100%;text-align:center;">
					<!-- share buttons -->
					<div class="fb-share-button" data-href="<%= request.original_url %>?12345" data-layout="button" style="padding: 0px; vertical-align: top; width: 106px; height: 24px;"></div>

					<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
					<g:plusone></g:plusone>

					<a href="https://twitter.com/share" class="twitter-share-button" data-url="<%= request.original_url %>" data-hashtags="twonoo" data-text="Check out TwoNoo!">Tweet</a>
					<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <%@imageURL = "assets/TwoNoo-Logo.png"%>
					<a href="//www.pinterest.com/pin/create/button/?url=<%= request.original_url %>&description=Check out TwoNoo!&media=<%=root_url%><%=@imageURL%>" data-pin-do="buttonPin" data-pin-config="beside" data-pin-color="red"><img src="//assets.pinterest.com/images/pidgets/pinit_fg_en_rect_red_20.png" /></a>

					<!-- Please call pinit.js only once per page -->
					<script type="text/javascript" async src="//assets.pinterest.com/js/pinit.js"></script>
</div>
      </div>
      <div class="modal-footer">
        <button id="cancelInvite" type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button id="sendInvites" type="button" class="btn btn-primary">Send Invites</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="invite_info" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
	Invitations Sent!
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script>
  $(function(){
    <%
      if cookies[:new_user] == 'true' %>
        $('#invite_people_form').modal('show');
    <%  cookies[:new_user] = 'false'
      end %>

    $('#sendInvites').bind('click', function(){invitePeople();});
    $('#cancelInvite').bind('click', function(){$('#emails').val('');});

    var invitePeople = function() {
      if(validateEmails())
      {
        $.ajax({
          type: "POST",
          url: "<%=twonoo_invite_people_path%>",
          data: { emails: $('#emails').val()},
          success: function(html) {
            $('#invite_info').modal('show');
            $('#emails').val('');
          },
          error: function(html) {alert('error');}
         });
    
        $('#invite_people_form').modal('hide'); 
      }
    };

    function validateEmails()
    {
      var emails = $('#emails').val();
      var emailArray = emails.split(',');
      var i;

      for (i = 0; i < emailArray.length; i++)
      {
        var email = emailArray[i].trim();
        if (!IsEmail(email))
        {
          alert("Please verify e-mail addresses to ensure they are valid.");
          return false;
        }
      }

      return true;
    }

    function IsEmail(email) {
      var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
      return regex.test(email);
    }

  });
</script>



